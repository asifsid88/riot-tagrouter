<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<title>Tests for riot-tagrouter</title>
</head>

<body>
	<app-route></app-route>
	
	<script src="./js/vendor/mocha.js"></script>
	<script src="./js/vendor/chai.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/riot/2.6.1/riot+compiler.min.js"></script>
	<script src="../build/routerlib.js"></script>
	<script src="./tags/app-route.tag" type="riot/tag"></script>
	<!--<script src="js/vendor/simulant.js"></script>-->
	<script>
		mocha.setup('bdd');
		// Setup chai
		var assert = chai.assert,
			should = chai.should,
			expect = chai.expect;
	</script>
	<!--<script src="./tags/tags.js"></script>
	<script src="js/tests.js"></script>-->
	<script>
	window.onload = function() {
		riot.mount('app-route',{})
		var runner;
		if (window.mochaPhantomJS) {
			mochaPhantomJS.run();
			var failedTests = [];
			runner.on('end', function() {
				window.mochaResults = runner.stats;
				window.mochaResults.reports = failedTests;
			});
			runner.on('fail', logFailure);
			function logFailure(test, err) {
				var flattenTitles = function(test) {
					var titles = [];
					while (test.parent.title) {
						titles.push(test.parent.title);
						test = test.parent;
					}
					return titles.reverse();
				};
				failedTests.push({
					name: test.title,
					result: false,
					message: err.message,
					stack: err.stack,
					titles: flattenTitles(test)
				});
			}
		}
	};
	</script>
</body>

</html>
