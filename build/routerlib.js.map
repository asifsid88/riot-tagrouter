{"version":3,"sources":["router_tags_es6.js"],"names":["riot","tag2","opts","self","nagivateToRoute","e","preventDefault","route","to","title","replace","on","Object","keys","tags","length","parent","setRoute","path","component","$appRoot","currTag","routeParams","unmountCurrRoute","console","log","createRouteWithTagName","tagName","tag","param","innerHTML","mountedTag","mount","trigger","Function","changeRoute","newRoute","window","Promise","then","tokenRegExp","params","match","map","substring","forEach","index","showRoutes","routeContainer","root","querySelector","remove","start"],"mappings":"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","file":"routerlib.js","sourcesContent":["riot.tag2('navigate', '<a href=\"{opts.to}\" onclick=\"{nagivateToRoute}\"><yield></yield></a>', '', '', function(opts) {\n        var self = this;\n        this.nagivateToRoute = function(e){\n            e.preventDefault();\n            riot.route(self.opts.to,self.opts.title||null,self.opts.replace?true:false);\n        }\n});\nriot.tag2('route', '<yield></yield>', '', '', function(opts) {\n\t\t\t\tthis.on('mount',(e)=>{\n\t\t\t\t\t\tif(Object.keys(this.tags).length===0){\n\t\t\t\t\t\t\tthis.parent && this.parent.setRoute && this.parent.setRoute(this.opts.path, this.opts.component );\n\t\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.setRoute = function(path, component){\n\t\t\t\t\tthis.parent && this.parent.setRoute && this.parent.setRoute(this.opts.path + path, component );\n\t\t\t\t}\n});\nriot.tag2('router', '<div class=\"route-container\"><yield></yield></div><div class=\"riot-root\"></div>', '', '', function(opts) {\n\t\t\t\tvar self = this;\n        var $appRoot = null;\n        var currTag = null;\n\n        var routeParams = {};\n\n        function unmountCurrRoute(){\n            if(currTag){\n                console.log(currTag);\n                debugger;\n            }\n        }\n\n        function createRouteWithTagName(tagName){\n\n\t\t\t\t\t\tvar tag = '<'+tagName+' class=\"route-'+tagName+'\" ';\n\t\t\t\t\t\tfor(var param in routeParams){\n\t\t\t\t\t\t\ttag = tag + param + '=\"' + routeParams[param] + '\" ';\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttag = tag + '></'+tagName+'>';\n\n\t\t\t\t\t\tunmountCurrRoute();\n\n\t\t\t\t\t\t$appRoot.innerHTML = tag;\n            var mountedTag = riot.mount(tagName+'.'+tagName);\n            if(mountedTag.length === 0){\n\t\t\t\t\t\t\t\tself.trigger('tagNotFound',tagName);\n\t\t\t\t\t\t\t\tif(self.opts['on-tagnotfound'] && self.opts['on-tagnotfound'] instanceof Function){\n\t\t\t\t\t\t\t\t\tself.opts['on-tagnotfound'](tagName);\n\t\t\t\t\t\t\t\t}\n\n            }\n            else{\n\t\t\t\t\t\t\t\tself.trigger('routeChanged',tagName);\n\t\t\t\t\t\t\t\tif(self.opts['on-routechange'] && self.opts['on-routechange'] instanceof Function){\n\t\t\t\t\t\t\t\t\tself.opts['on-routechange'](tagName);\n\t\t\t\t\t\t\t\t}\n                currTag = mountedTag[0];\n            }\n        }\n\n        function changeRoute(newRoute){\n            if(typeof(newRoute) === 'string'){\n                createRouteWithTagName(newRoute);\n            } else if ((window.Promise) && (newRoute instanceof window.Promise)){\n                newRoute.then(tagName  => {\n\t\t\t\t\t\t\t\t\tcreateRouteWithTagName(tagName);\n\t\t\t\t\t\t\t\t});\n            }\n        }\n\n        this.setRoute = function(path, component){\n            (function(path, component){\n\n\t\t\t\t\t\t\t\tvar tokenRegExp = /:([a-z]*)/ig;\n\n            \t\tvar params = path.match(tokenRegExp);\n\t\t\t\t\t\t\t\tparams = params.map(param=> param.length>0 ? param.substring(1): '');\n\n\t\t\t\t\t\t\t\tpath = path.replace(tokenRegExp,'*');\n\n                riot.route(path,function() {\n\n\t\t\t\t\t\t\t\t\t\trouteParams={};\n\n\t\t\t\t\t\t\t\t\t\tparams.forEach((param,index) => {\n\t\t\t\t\t\t\t\t\t\t\trouteParams[param] = arguments[index];\n\t\t\t\t\t\t\t\t\t\t});\n\n                    changeRoute(component);\n                });\n            })(path, component)\n        }\n\n        this.on('mount',(e)=>{\n\n\t\t\t\t\t\tif(!this.opts.showRoutes){\n\t\t\t\t\t\t\tvar routeContainer = this.root.querySelector('.route-container');\n\t\t\t\t\t\t\trouteContainer.remove && routeContainer.remove();\n\t\t\t\t\t\t}\n\n            $appRoot = this.root.querySelector('.riot-root');\n            riot.route.start(true);\n        });\n\n});\n"]}